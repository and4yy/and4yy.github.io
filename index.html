<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Invoice Generator</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #f5f7fa;
    margin: 0;
    padding: 20px;
    color: #333;
  }
  .container {
    max-width: 700px;
    background: #fff;
    padding: 30px 40px;
    margin: 0 auto;
    border-radius: 8px;
    box-shadow: 0 8px 18px rgba(0,0,0,0.1);
  }
  header {
    text-align: center;
    margin-bottom: 25px;
    position: relative;
  }
  header img {
    max-height: 70px;
  }
  h1 {
    margin-top: 10px;
    font-weight: 700;
    font-size: 28px;
    color: #0055a5;
  }
  form {
    margin-bottom: 20px;
  }
  .row {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
    flex-wrap: wrap;
  }
  .row > div {
    flex: 1;
    min-width: 120px;
  }
  label {
    display: block;
    margin-bottom: 5px;
    font-weight: 600;
  }
  input[type="text"],
  input[type="number"],
  input[type="tel"] {
    width: 100%;
    padding: 8px 12px;
    border: 1.5px solid #ccc;
    border-radius: 6px;
    font-size: 15px;
    transition: border-color 0.3s;
  }
  input[type="text"]:focus,
  input[type="number"]:focus,
  input[type="tel"]:focus {
    border-color: #0055a5;
    outline: none;
  }
  .items-list {
    margin-top: 20px;
  }
  .items-list > div {
    display: flex;
    gap: 10px;
    margin-bottom: 12px;
  }
  .items-list input {
    flex: 1;
  }
  .items-list input.price,
  .items-list input.quantity {
    max-width: 90px;
  }
  button {
    background-color: #007bff;
    border: none;
    color: white;
    padding: 12px 20px;
    font-size: 16px;
    border-radius: 7px;
    cursor: pointer;
    transition: background-color 0.3s;
    margin-right: 10px;
  }
  button:hover {
    background-color: #0056b3;
  }
  .btn-danger {
    background-color: #dc3545;
  }
  .btn-danger:hover {
    background-color: #a71d2a;
  }
  .btn-success {
    background-color: #28a745;
  }
  .btn-success:hover {
    background-color: #1e7e34;
  }
  .invoice-output {
    background: #fff;
    padding: 20px 25px;
    border-radius: 8px;
    box-shadow: 0 6px 15px rgba(0,0,0,0.08);
    color: #222;
    font-size: 16px;
    position: relative;
    min-height: 500px;
  }
  .invoice-header {
    border-bottom: 3px solid #0055a5;
    padding-bottom: 15px;
    margin-bottom: 25px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 15px;
  }
  .invoice-header h2 {
    margin: 0;
    color: #0055a5;
    font-size: 28px;
    flex: 1 1 auto;
  }
  .invoice-header .company-info {
    text-align: right;
    font-size: 14px;
    flex: 1 1 auto;
    min-width: 220px;
  }
  .invoice-header .company-logo {
    max-height: 60px;
    flex-shrink: 0;
  }
  .invoice-details {
    display: flex;
    justify-content: space-between;
    margin-bottom: 25px;
    font-size: 16px;
    flex-wrap: wrap;
    gap: 15px;
  }
  .invoice-details div {
    flex: 1 1 45%;
    min-width: 220px;
  }
  .invoice-details .customer-info {
    padding-right: 20px;
  }
  .invoice-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 25px;
  }
  .invoice-table th,
  .invoice-table td {
    padding: 12px 10px;
    border-bottom: 1.5px solid #ccc;
    font-weight: 600;
  }
  /* Left align the first column (Item) */
  .invoice-table th:first-child,
  .invoice-table td:first-child {
    text-align: left;
    font-weight: 600;
  }
  /* Right align Price, Qty, Total */
  .invoice-table th:nth-child(n+2),
  .invoice-table td:nth-child(n+2) {
    text-align: right;
    font-weight: 600;
  }
  /* Normal font weight for body cells */
  .invoice-table tbody td {
    font-weight: normal;
  }
  .invoice-table tr:nth-child(even) {
    background-color: #f7f9fc;
  }
  .summary {
    max-width: 320px;
    margin-left: auto;
    font-size: 18px;
  }
  .summary div {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
  }
  .summary div.total {
    font-weight: 700;
    font-size: 22px;
    border-top: 3px solid #0055a5;
    padding-top: 12px;
  }
  .currency {
    margin-left: 4px;
  }

  /* Customer Name & Phone inputs inline */
  .customer-phone-row {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
  }
  .customer-phone-row > div {
    flex: 1;
    min-width: 150px;
  }

  /* Footer with bank details */
  .invoice-footer {
    border-top: 2px solid #ddd;
    padding-top: 15px;
    margin-top: 35px;
    font-size: 14px;
    color: #555;
    text-align: center;
    line-height: 1.5;
  }

  @media (max-width: 600px) {
    .row,
    .customer-phone-row {
      flex-direction: column;
    }
    .invoice-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 10px;
    }
    .invoice-details {
      flex-direction: column;
      gap: 10px;
    }
    .summary {
      margin-left: 0;
      max-width: 100%;
    }
  }
</style>
</head>
<body>
<div class="container">
  <header>
    <img src="https://github.com/and4yy/and4yy.github.io/blob/master/BitsyBox_logo1.png?raw=true" alt="Company Logo" />
    <h1>BitsyBox Invoice Generator</h1>
  </header>

  <form id="invoice-form">
    <div class="row">
      <div>
        <label>Invoice Number</label>
        <input type="text" id="invoice-number" readonly />
      </div>
      <div>
        <label>Date</label>
        <input type="text" id="invoice-date" readonly />
      </div>
    </div>

    <div class="customer-phone-row">
      <div>
        <label>Customer Name</label>
        <input type="text" id="customer-name" placeholder="Customer Name" required />
      </div>
      <div>
        <label>Phone Number</label>
        <input type="tel" id="customer-phone" placeholder="Phone Number" required />
      </div>
    </div>

    <div class="items-list" id="items-list">
      <label>Items</label>
      <div>
        <input type="text" class="item-name" placeholder="Item Description" required />
        <input type="number" class="price" placeholder="Price (MVR)" min="0" step="0.01" required />
        <input type="number" class="quantity" placeholder="Qty" min="1" step="1" required />
        <button type="button" class="btn-danger" onclick="removeItem(this)">✕</button>
      </div>
    </div>

    <button type="button" class="btn-success" onclick="addItem()">+ Add Item</button>

    <div class="row" style="margin-top: 25px;">
      <div>
        <label>Subtotal (MVR)</label>
        <input type="text" id="subtotal" readonly />
      </div>
      <div>
        <label>Discount (MVR)</label>
        <input type="number" id="discount" min="0" step="0.01" value="0" />
      </div>
      <div>
        <label>Tax (GST %) </label>
        <input type="number" id="tax" min="0" step="0.01" value="6" />
      </div>
      <div>
        <label>Total (MVR)</label>
        <input type="text" id="total" readonly />
      </div>
    </div>

    <div style="margin-top: 20px;">
      <button type="button" onclick="generateInvoice()">Generate Invoice</button>
      <button type="button" onclick="downloadInvoice()">Download PNG</button>
      <button type="button" onclick="shareWhatsApp()">Share via WhatsApp</button>
    </div>
  </form>

  <div id="invoice-output" class="invoice-output" style="display:none;"></div>
</div>

<script>
  function formatDate(date) {
    const d = new Date(date);
    const month = '' + (d.getMonth() + 1);
    const day = '' + d.getDate();
    const year = d.getFullYear();
    return [year, month.padStart(2, '0'), day.padStart(2, '0')].join('-');
  }

  function initInvoice() {
    const invoiceNumInput = document.getElementById('invoice-number');
    const dateInput = document.getElementById('invoice-date');
    const storedNum = localStorage.getItem('lastInvoiceNumber');
    let invoiceNum = storedNum ? parseInt(storedNum) + 1 : 1001;
    invoiceNumInput.value = invoiceNum;
    dateInput.value = formatDate(new Date());
    localStorage.setItem('lastInvoiceNumber', invoiceNum);
  }

  function addItem() {
    const itemsList = document.getElementById('items-list');
    const div = document.createElement('div');
    div.innerHTML = `
      <input type="text" class="item-name" placeholder="Item Description" required />
      <input type="number" class="price" placeholder="Price (MVR)" min="0" step="0.01" required />
      <input type="number" class="quantity" placeholder="Qty" min="1" step="1" required />
      <button type="button" class="btn-danger" onclick="removeItem(this)">✕</button>
    `;
    itemsList.appendChild(div);
  }

  function removeItem(btn) {
    const itemsList = document.getElementById('items-list');
    if (itemsList.children.length > 2) {
      btn.parentElement.remove();
    } else {
      alert('At least one item is required.');
    }
  }

  function calculateTotals() {
    const prices = document.querySelectorAll('.price');
    const quantities = document.querySelectorAll('.quantity');

    let subtotal = 0;
    for (let i = 0; i < prices.length; i++) {
      const price = parseFloat(prices[i].value) || 0;
      const qty = parseInt(quantities[i].value) || 0;
      subtotal += price * qty;
    }

    document.getElementById('subtotal').value = subtotal.toFixed(2);

    const discount = parseFloat(document.getElementById('discount').value) || 0;
    const taxPercent = parseFloat(document.getElementById('tax').value) || 0;

    const discounted = Math.max(subtotal - discount, 0);
    const taxAmount = (discounted * taxPercent) / 100;
    const total = discounted + taxAmount;

    document.getElementById('total').value = total.toFixed(2);
  }

  function generateInvoice() {
    if (!document.getElementById('invoice-form').checkValidity()) {
      alert('Please fill all required fields correctly.');
      return;
    }
    calculateTotals();

    const invoiceNumber = document.getElementById('invoice-number').value;
    const invoiceDate = document.getElementById('invoice-date').value;
    const customerName = document.getElementById('customer-name').value.trim();
    const customerPhone = document.getElementById('customer-phone').value.trim();
    const customerInfo = `${customerName} | ${customerPhone}`;

    const prices = document.querySelectorAll('.price');
    const quantities = document.querySelectorAll('.quantity');
    const items = document.querySelectorAll('.item-name');

    let itemsHTML = '';
    for (let i = 0; i < items.length; i++) {
      const itemName = items[i].value;
      const price = parseFloat(prices[i].value).toFixed(2);
      const qty = quantities[i].value;
      const total = (price * qty).toFixed(2);

      itemsHTML += `
        <tr>
          <td>${itemName}</td>
          <td class="price">MVR ${price}</td>
          <td class="quantity">${qty}</td>
          <td class="total">MVR ${total}</td>
        </tr>
      `;
    }

    const subtotal = document.getElementById('subtotal').value;
    const discount = document.getElementById('discount').value || "0.00";
    const taxPercent = document.getElementById('tax').value;
    const taxAmount = ((subtotal - discount) * taxPercent / 100).toFixed(2);
    const total = document.getElementById('total').value;

    const invoiceOutput = document.getElementById('invoice-output');

    invoiceOutput.innerHTML = `
      <div class="invoice-header">
        <img class="company-logo" src="https://github.com/and4yy/and4yy.github.io/blob/master/BitsyBox_logo1.png?raw=true" alt="BitsyBox Logo" />
        <div class="company-info">
          <div>H.Gadhage, Male' City</div>
          <div>+960 737-1611</div>
          <div><small>GST: Fixed</small></div>
        </div>
      </div>

      <div class="invoice-details">
        <div class="customer-info">
          <strong>Customer:</strong> ${customerInfo}
        </div>
        <div>
          <div><strong>Invoice #:</strong> ${invoiceNumber}</div>
          <div><strong>Date:</strong> ${invoiceDate}</div>
        </div>
      </div>

      <table class="invoice-table" cellspacing="0" cellpadding="0">
        <thead>
          <tr>
            <th>Item</th>
            <th>Price</th>
            <th>Qty</th>
            <th>Total</th>
          </tr>
        </thead>
        <tbody>
          ${itemsHTML}
        </tbody>
      </table>

      <div class="summary">
        <div><span>Subtotal:</span><span>MVR ${subtotal}</span></div>
        <div><span>Discount:</span><span>MVR ${parseFloat(discount).toFixed(2)}</span></div>
        <div><span>Tax (GST ${taxPercent}%):</span><span>MVR ${taxAmount}</span></div>
        <div class="total"><span>Total:</span><span>MVR ${total}</span></div>
      </div>

      <div class="invoice-footer">
        <div><strong>Bank Details:</strong></div>
        <div>Bank: Maldives Islamic Bank</div>
        <div>Account Name: BitsyBox Pvt Ltd</div>
        <div>Account Number: 1234567890</div>
        <div>IBAN: MV12MIBK0001234567890</div>
      </div>
    `;

    invoiceOutput.style.display = 'block';
  }

  function downloadInvoice() {
    const invoiceOutput = document.getElementById('invoice-output');
    if (!invoiceOutput.innerHTML.trim()) {
      alert('Please generate the invoice first.');
      return;
    }
    html2canvas(invoiceOutput).then(canvas => {
      const link = document.createElement('a');
      link.download = `invoice_${document.getElementById('invoice-number').value}.png`;
      link.href = canvas.toDataURL();
      link.click();
    });
  }

  function shareWhatsApp() {
    const invoiceOutput = document.getElementById('invoice-output');
    if (!invoiceOutput.innerHTML.trim()) {
      alert('Please generate the invoice first.');
      return;
    }

    html2canvas(invoiceOutput).then(canvas => {
      const link = document.createElement('a');
      const invoiceNumber = document.getElementById('invoice-number').value;
      link.download = `invoice_${invoiceNumber}.png`;
      link.href = canvas.toDataURL();
      link.click();

      let message = `Invoice #${invoiceNumber}%0A`;
      message += `Date: ${document.getElementById('invoice-date').value}%0A`;
      message += `Customer: ${document.getElementById('customer-name').value.trim()} | ${document.getElementById('customer-phone').value.trim()}%0A%0AItems:%0A`;

      const items = document.querySelectorAll('.item-name
');
const prices = document.querySelectorAll('.price');
const quantities = document.querySelectorAll('.quantity');
  for (let i = 0; i < items.length; i++) {
    message += `- ${items[i].value}: ${prices[i].value} MVR x ${quantities[i].value}%0A`;
  }

  message += `%0ASubtotal: MVR ${document.getElementById('subtotal').value}%0A`;
  message += `Discount: MVR ${document.getElementById('discount').value || '0.00'}%0A`;
  message += `Tax: MVR ${((parseFloat(document.getElementById('subtotal').value) - parseFloat(document.getElementById('discount').value || 0)) * parseFloat(document.getElementById('tax').value)/100).toFixed(2)}%0A`;
  message += `Total: MVR ${document.getElementById('total').value}`;

  const whatsappURL = `https://wa.me/?text=${message}`;
  window.open(whatsappURL, '_blank');
});
}

document.getElementById('discount').addEventListener('input', calculateTotals);
document.getElementById('tax').addEventListener('input', calculateTotals);
document.getElementById('items-list').addEventListener('input', e => {
if (e.target.classList.contains('price') || e.target.classList.contains('quantity')) {
calculateTotals();
}
});

window.onload = () => {
initInvoice();
addItem();
calculateTotals();
};
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script> </body> </html> ```
